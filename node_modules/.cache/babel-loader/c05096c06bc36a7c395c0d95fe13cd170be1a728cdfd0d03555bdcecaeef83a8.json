{"ast":null,"code":"import DisasterTrackingService from './api/disasterTrackingService.js';\nimport MeteomaticsService from './api/meteomaticsService.js';\nimport Oco2Service from './api/oco2Service.js';\nimport { processHistoricalData, mergeDataSources, validateDataIntegrity } from './utils/dataProcessor.js';\n\n/**\n * Main Weather Service - Orchestrates all weather-related data sources\n * This is the primary service that components should interact with\n */\nclass WeatherService {\n  constructor() {\n    // Initialize individual service modules\n    this.disasterTrackingService = new DisasterTrackingService();\n    this.meteomaticsService = new MeteomaticsService();\n    this.oco2Service = new Oco2Service();\n\n    // Service configuration\n    this.config = {\n      enableDisasterTracking: true,\n      enableCo2Monitoring: true,\n      defaultDayRange: 7,\n      maxRetries: 3\n    };\n  }\n\n  /**\n   * Get comprehensive weather data for a location and date\n   * @param {number} lat - Latitude\n   * @param {number} lon - Longitude\n   * @param {string} targetDate - Target date for analysis\n   * @returns {Promise<Object>} Complete weather analysis\n   */\n  async getWeatherAnalysis(lat, lon, targetDate) {\n    try {\n      console.log(`Fetching comprehensive weather analysis for ${lat}, ${lon} on ${targetDate}`);\n\n      // Validate inputs\n      if (!this.meteomaticsService.isValidCoordinates(lat, lon)) {\n        throw new Error('Invalid coordinates provided');\n      }\n\n      // Fetch data from NASA-approved Meteomatics API\n      const weatherData = await this.meteomaticsService.fetchWeatherData(lat, lon, targetDate);\n\n      // Process historical weather data\n      const processedWeatherData = processHistoricalData(weatherData.daily, weatherData.monthly);\n\n      // Merge data sources\n      const mergedData = mergeDataSources({\n        ...weatherData,\n        ...processedWeatherData\n      }, null);\n\n      // Validate data integrity\n      const validation = validateDataIntegrity(mergedData);\n      if (!validation.isValid) {\n        console.warn('Data validation failed:', validation.errors);\n      }\n\n      // Add validation results to response\n      mergedData.validation = validation;\n      console.log('Weather analysis completed successfully');\n      return mergedData;\n    } catch (error) {\n      console.error('Error in weather analysis:', error);\n      throw error;\n    }\n  }\n\n  /**\n   * Get disaster events for storm tracking\n   * @param {number} days - Number of days to look back\n   * @param {string} status - Event status filter\n   * @returns {Promise<Array>} Array of disaster events\n   */\n  async getDisasterEvents(days = 30, status = 'open') {\n    try {\n      if (!this.config.enableDisasterTracking) {\n        console.log('Disaster tracking is disabled');\n        return [];\n      }\n      return await this.disasterTrackingService.fetchDisasterEvents(days, status);\n    } catch (error) {\n      console.error('Error fetching disaster events:', error);\n      return [];\n    }\n  }\n\n  /**\n   * Filter disaster events by criteria\n   * @param {Array} events - Array of disaster events\n   * @param {Object} filters - Filter criteria\n   * @returns {Array} Filtered events\n   */\n  filterDisasterEvents(events, filters = {}) {\n    let filteredEvents = [...events];\n    if (filters.category && filters.category !== 'all') {\n      filteredEvents = this.disasterTrackingService.filterByCategory(filteredEvents, filters.category);\n    }\n    if (filters.severity && filters.severity !== 'all') {\n      filteredEvents = this.disasterTrackingService.filterBySeverity(filteredEvents, filters.severity);\n    }\n    return filteredEvents;\n  }\n\n  /**\n   * Get disaster event statistics\n   * @param {Array} events - Array of disaster events\n   * @returns {Object} Event statistics\n   */\n  getDisasterStatistics(events) {\n    return this.disasterTrackingService.getEventStatistics(events);\n  }\n\n  /**\n   * Get event icon for disaster category\n   * @param {string} categoryId - Event category ID\n   * @returns {string} Emoji icon\n   */\n  getDisasterEventIcon(categoryId) {\n    return this.disasterTrackingService.getEventIcon(categoryId);\n  }\n\n  /**\n   * Export weather data in specified format\n   * @param {Object} data - Weather data to export\n   * @param {string} format - Export format ('json' or 'csv')\n   * @returns {string|Object} Formatted export data\n   */\n  exportData(data, format = 'json') {\n    const {\n      formatForExport\n    } = require('./utils/dataProcessor.js');\n    return formatForExport(data, format);\n  }\n\n  /**\n   * Get service status and configuration\n   * @returns {Object} Service status information\n   */\n  getServiceStatus() {\n    return {\n      services: {\n        meteomatics: this.meteomaticsService.getApiStatus(),\n        disasterTracking: {\n          service: 'NASA EONET Disaster Tracking (Thunderstorms)',\n          enabled: this.config.enableDisasterTracking,\n          baseUrl: this.disasterTrackingService.baseUrl\n        }\n      },\n      configuration: this.config,\n      lastUpdated: new Date().toISOString()\n    };\n  }\n\n  /**\n   * Update service configuration\n   * @param {Object} newConfig - New configuration options\n   */\n  updateConfiguration(newConfig) {\n    this.config = {\n      ...this.config,\n      ...newConfig\n    };\n    console.log('Service configuration updated:', this.config);\n  }\n\n  /**\n   * Health check for all services\n   * @returns {Promise<Object>} Health status of all services\n   */\n  async healthCheck() {\n    const health = {\n      overall: 'healthy',\n      services: {},\n      timestamp: new Date().toISOString()\n    };\n    try {\n      // Check Meteomatics service\n      health.services.meteomatics = {\n        status: this.meteomaticsService.validateCredentials() ? 'healthy' : 'degraded',\n        message: 'Credentials validated'\n      };\n\n      // Check disaster tracking service\n      try {\n        const testEvents = this.disasterTrackingService.getEventStatistics([]);\n        health.services.disasterTracking = {\n          status: 'healthy',\n          message: 'Service operational'\n        };\n      } catch (error) {\n        health.services.disasterTracking = {\n          status: 'unhealthy',\n          message: error.message\n        };\n        health.overall = 'degraded';\n      }\n    } catch (error) {\n      health.overall = 'unhealthy';\n      health.error = error.message;\n    }\n    return health;\n  }\n}\n\n// Export singleton instance\nexport const weatherService = new WeatherService();\nexport default WeatherService;","map":{"version":3,"names":["DisasterTrackingService","MeteomaticsService","Oco2Service","processHistoricalData","mergeDataSources","validateDataIntegrity","WeatherService","constructor","disasterTrackingService","meteomaticsService","oco2Service","config","enableDisasterTracking","enableCo2Monitoring","defaultDayRange","maxRetries","getWeatherAnalysis","lat","lon","targetDate","console","log","isValidCoordinates","Error","weatherData","fetchWeatherData","processedWeatherData","daily","monthly","mergedData","validation","isValid","warn","errors","error","getDisasterEvents","days","status","fetchDisasterEvents","filterDisasterEvents","events","filters","filteredEvents","category","filterByCategory","severity","filterBySeverity","getDisasterStatistics","getEventStatistics","getDisasterEventIcon","categoryId","getEventIcon","exportData","data","format","formatForExport","require","getServiceStatus","services","meteomatics","getApiStatus","disasterTracking","service","enabled","baseUrl","configuration","lastUpdated","Date","toISOString","updateConfiguration","newConfig","healthCheck","health","overall","timestamp","validateCredentials","message","testEvents","weatherService"],"sources":["C:/xampp/htdocs/errors/src/services/weatherService.js"],"sourcesContent":["import DisasterTrackingService from './api/disasterTrackingService.js';\nimport MeteomaticsService from './api/meteomaticsService.js';\nimport Oco2Service from './api/oco2Service.js';\nimport { processHistoricalData, mergeDataSources, validateDataIntegrity } from './utils/dataProcessor.js';\n\n/**\n * Main Weather Service - Orchestrates all weather-related data sources\n * This is the primary service that components should interact with\n */\nclass WeatherService {\n  constructor() {\n    // Initialize individual service modules\n    this.disasterTrackingService = new DisasterTrackingService();\n    this.meteomaticsService = new MeteomaticsService();\n    this.oco2Service = new Oco2Service();\n    \n    // Service configuration\n    this.config = {\n      enableDisasterTracking: true,\n      enableCo2Monitoring: true,\n      defaultDayRange: 7,\n      maxRetries: 3\n    };\n  }\n\n  /**\n   * Get comprehensive weather data for a location and date\n   * @param {number} lat - Latitude\n   * @param {number} lon - Longitude\n   * @param {string} targetDate - Target date for analysis\n   * @returns {Promise<Object>} Complete weather analysis\n   */\n  async getWeatherAnalysis(lat, lon, targetDate) {\n    try {\n      console.log(`Fetching comprehensive weather analysis for ${lat}, ${lon} on ${targetDate}`);\n      \n      // Validate inputs\n      if (!this.meteomaticsService.isValidCoordinates(lat, lon)) {\n        throw new Error('Invalid coordinates provided');\n      }\n\n      // Fetch data from NASA-approved Meteomatics API\n      const weatherData = await this.meteomaticsService.fetchWeatherData(lat, lon, targetDate);\n\n      // Process historical weather data\n      const processedWeatherData = processHistoricalData(weatherData.daily, weatherData.monthly);\n      \n      // Merge data sources\n      const mergedData = mergeDataSources(\n        { ...weatherData, ...processedWeatherData },\n        null\n      );\n\n      // Validate data integrity\n      const validation = validateDataIntegrity(mergedData);\n      if (!validation.isValid) {\n        console.warn('Data validation failed:', validation.errors);\n      }\n\n      // Add validation results to response\n      mergedData.validation = validation;\n      \n      console.log('Weather analysis completed successfully');\n      return mergedData;\n\n    } catch (error) {\n      console.error('Error in weather analysis:', error);\n      throw error;\n    }\n  }\n\n  /**\n   * Get disaster events for storm tracking\n   * @param {number} days - Number of days to look back\n   * @param {string} status - Event status filter\n   * @returns {Promise<Array>} Array of disaster events\n   */\n  async getDisasterEvents(days = 30, status = 'open') {\n    try {\n      if (!this.config.enableDisasterTracking) {\n        console.log('Disaster tracking is disabled');\n        return [];\n      }\n\n      return await this.disasterTrackingService.fetchDisasterEvents(days, status);\n    } catch (error) {\n      console.error('Error fetching disaster events:', error);\n      return [];\n    }\n  }\n\n\n  /**\n   * Filter disaster events by criteria\n   * @param {Array} events - Array of disaster events\n   * @param {Object} filters - Filter criteria\n   * @returns {Array} Filtered events\n   */\n  filterDisasterEvents(events, filters = {}) {\n    let filteredEvents = [...events];\n\n    if (filters.category && filters.category !== 'all') {\n      filteredEvents = this.disasterTrackingService.filterByCategory(filteredEvents, filters.category);\n    }\n\n    if (filters.severity && filters.severity !== 'all') {\n      filteredEvents = this.disasterTrackingService.filterBySeverity(filteredEvents, filters.severity);\n    }\n\n    return filteredEvents;\n  }\n\n  /**\n   * Get disaster event statistics\n   * @param {Array} events - Array of disaster events\n   * @returns {Object} Event statistics\n   */\n  getDisasterStatistics(events) {\n    return this.disasterTrackingService.getEventStatistics(events);\n  }\n\n  /**\n   * Get event icon for disaster category\n   * @param {string} categoryId - Event category ID\n   * @returns {string} Emoji icon\n   */\n  getDisasterEventIcon(categoryId) {\n    return this.disasterTrackingService.getEventIcon(categoryId);\n  }\n\n  /**\n   * Export weather data in specified format\n   * @param {Object} data - Weather data to export\n   * @param {string} format - Export format ('json' or 'csv')\n   * @returns {string|Object} Formatted export data\n   */\n  exportData(data, format = 'json') {\n    const { formatForExport } = require('./utils/dataProcessor.js');\n    return formatForExport(data, format);\n  }\n\n  /**\n   * Get service status and configuration\n   * @returns {Object} Service status information\n   */\n  getServiceStatus() {\n    return {\n      services: {\n        meteomatics: this.meteomaticsService.getApiStatus(),\n        disasterTracking: {\n          service: 'NASA EONET Disaster Tracking (Thunderstorms)',\n          enabled: this.config.enableDisasterTracking,\n          baseUrl: this.disasterTrackingService.baseUrl\n        }\n      },\n      configuration: this.config,\n      lastUpdated: new Date().toISOString()\n    };\n  }\n\n  /**\n   * Update service configuration\n   * @param {Object} newConfig - New configuration options\n   */\n  updateConfiguration(newConfig) {\n    this.config = { ...this.config, ...newConfig };\n    console.log('Service configuration updated:', this.config);\n  }\n\n  /**\n   * Health check for all services\n   * @returns {Promise<Object>} Health status of all services\n   */\n  async healthCheck() {\n    const health = {\n      overall: 'healthy',\n      services: {},\n      timestamp: new Date().toISOString()\n    };\n\n    try {\n      // Check Meteomatics service\n      health.services.meteomatics = {\n        status: this.meteomaticsService.validateCredentials() ? 'healthy' : 'degraded',\n        message: 'Credentials validated'\n      };\n\n\n      // Check disaster tracking service\n      try {\n        const testEvents = this.disasterTrackingService.getEventStatistics([]);\n        health.services.disasterTracking = { status: 'healthy', message: 'Service operational' };\n      } catch (error) {\n        health.services.disasterTracking = { status: 'unhealthy', message: error.message };\n        health.overall = 'degraded';\n      }\n\n    } catch (error) {\n      health.overall = 'unhealthy';\n      health.error = error.message;\n    }\n\n    return health;\n  }\n}\n\n// Export singleton instance\nexport const weatherService = new WeatherService();\nexport default WeatherService;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}