{"ast":null,"code":"import DisasterTrackingService from './api/disasterTrackingService.js';\nimport EonetService from './api/eonetService.js';\nimport PowerService from './api/powerService.js';\nimport DonkiService from './api/donkiService.js';\nimport { processHistoricalData, mergeDataSources, validateDataIntegrity } from './utils/dataProcessor.js';\n\n/**\n * Main Weather Service - Orchestrates all weather-related data sources\n * This is the primary service that components should interact with\n */\nclass WeatherService {\n  constructor() {\n    // Initialize individual service modules\n    this.disasterTrackingService = new DisasterTrackingService();\n    this.eonetService = EonetService;\n    this.powerService = PowerService;\n    this.donkiService = DonkiService;\n\n    // Service configuration\n    this.config = {\n      enableDisasterTracking: true,\n      enableSpaceWeather: true,\n      defaultDayRange: 7,\n      maxRetries: 3\n    };\n  }\n\n  /**\n   * Get comprehensive weather data for a location and date\n   * @param {number} lat - Latitude\n   * @param {number} lon - Longitude\n   * @param {string} targetDate - Target date for analysis\n   * @returns {Promise<Object>} Complete weather analysis\n   */\n  async getWeatherAnalysis(lat, lon, targetDate) {\n    try {\n      console.log(`Fetching comprehensive weather analysis for ${lat}, ${lon} on ${targetDate}`);\n\n      // Validate inputs\n      if (!this.isValidCoordinates(lat, lon)) {\n        throw new Error('Invalid coordinates provided');\n      }\n\n      // Ensure targetDate is a Date object and in ISO format\n      const targetDateObj = new Date(targetDate);\n      if (isNaN(targetDateObj.getTime())) {\n        throw new Error('Invalid date format provided');\n      }\n\n      // Calculate date range for weather data\n      const startDateObj = new Date(targetDateObj);\n      const endDateObj = new Date(targetDateObj);\n      startDateObj.setDate(startDateObj.getDate() - this.config.defaultDayRange);\n      endDateObj.setDate(endDateObj.getDate() + this.config.defaultDayRange);\n\n      // Format dates for different APIs and prepare parameters\n      const formattedStartDate = this.formatDateWithDashes(startDateObj);\n      const formattedEndDate = this.formatDateWithDashes(endDateObj);\n      const coordinates = {\n        lat,\n        lon\n      };\n\n      // Fetch data from all sources in parallel with robust error handling\n      const apiResults = await Promise.allSettled([\n      // Weather data from POWER API\n      this.powerService.fetchWeatherData(coordinates, formattedStartDate, formattedEndDate).catch(error => {\n        console.error('Weather data fetch failed:', error);\n        return {\n          temperature: null,\n          precipitation: null,\n          humidity: null\n        };\n      }),\n      // Storm events from EONET\n      this.eonetService.getWeatherEvents({\n        days: this.config.defaultDayRange,\n        status: 'all'\n      }).catch(error => {\n        console.error('Storm data fetch failed:', error);\n        return {\n          events: [],\n          alerts: []\n        };\n      }),\n      // Space weather from DONKI\n      this.donkiService.fetchSpaceWeatherData(formattedStartDate, formattedEndDate).catch(error => {\n        console.error('Space weather data fetch failed:', error);\n        return {\n          solarFlares: [],\n          geomagneticStorms: []\n        };\n      })]);\n\n      // Extract data with proper typing and fallbacks\n      const [{\n        value: powerWeatherData = {\n          temperature: null,\n          precipitation: null,\n          humidity: null\n        }\n      }, {\n        value: eonetData = {\n          events: [],\n          alerts: []\n        }\n      }, {\n        value: donkiData = {\n          solarFlares: [],\n          geomagneticStorms: []\n        }\n      }] = apiResults;\n      console.log('Fetching data for date range:', formattedStartDate, 'to', formattedEndDate);\n\n      // Fetch data from all sources in parallel\n      const [stormData, nearbyEvents, weatherData, spaceWeatherData] = await Promise.all([this.eonetService.getWeatherEvents({\n        days: this.config.defaultDayRange,\n        status: 'all'\n      }).catch(err => {\n        console.warn('EONET fetch failed:', err);\n        return [];\n      }), this.eonetService.getNearbyEvents(lat, lon, 500).catch(err => {\n        console.warn('Nearby events fetch failed:', err);\n        return [];\n      }), this.powerService.getWeatherData(lat, lon, powerStartDate, powerEndDate).catch(err => {\n        console.warn('NASA POWER fetch failed:', err);\n        return null;\n      }), this.config.enableSpaceWeather ? this.donkiService.getSpaceWeatherData(formattedStartDate, formattedEndDate).catch(err => {\n        console.warn('DONKI fetch failed:', err);\n        return null;\n      }) : null]);\n\n      // Process and validate weather data\n      let processedWeatherData = null;\n      let currentWeather = null;\n      if (weatherData && Array.isArray(weatherData)) {\n        try {\n          processedWeatherData = processHistoricalData(weatherData);\n          const targetDateFormatted = this.formatDate(targetDateObj);\n          currentWeather = weatherData.find(d => d.date === targetDateFormatted) || null;\n        } catch (err) {\n          console.warn('Error processing weather data:', err);\n        }\n      }\n\n      // Ensure all data is properly structured\n      const mergedData = {\n        storms: Array.isArray(stormData) ? stormData : [],\n        nearbyEvents: Array.isArray(nearbyEvents) ? nearbyEvents : [],\n        location: {\n          lat: Number(lat).toFixed(4),\n          lon: Number(lon).toFixed(4)\n        },\n        date: this.formatDateWithDashes(targetDateObj),\n        summary: this.generateWeatherSummary(Array.isArray(nearbyEvents) ? nearbyEvents : [], spaceWeatherData),\n        weather: {\n          historical: processedWeatherData,\n          current: currentWeather,\n          isValid: !!processedWeatherData\n        },\n        spaceWeather: spaceWeatherData || {\n          events: {},\n          summary: {\n            activityLevel: 'Unknown',\n            eventCounts: {},\n            impacts: {}\n          },\n          warnings: []\n        }\n      };\n\n      // Validate data integrity and add fallback data if needed\n      const validation = validateDataIntegrity(mergedData);\n      if (!validation.isValid) {\n        console.warn('Data validation warnings:', validation.errors);\n\n        // Add fallback data for missing components\n        if (!mergedData.weather.current) {\n          mergedData.weather.current = {\n            temperature: null,\n            precipitation: null,\n            windSpeed: null,\n            humidity: null,\n            condition: 'Unknown'\n          };\n        }\n      }\n\n      // Add validation results and metadata\n      mergedData.validation = {\n        ...validation,\n        dataTimestamp: new Date().toISOString(),\n        dataSources: {\n          eonet: !!stormData,\n          power: !!weatherData,\n          donki: !!spaceWeatherData\n        }\n      };\n      console.log('Weather analysis completed successfully');\n      return mergedData;\n    } catch (error) {\n      console.error('Error in weather analysis:', error);\n      throw error;\n    }\n  }\n\n  /**\n   * Add days to a date\n   * @param {string|Date} date - Input date\n   * @param {number} days - Number of days to add\n   * @returns {Date} Resulting date\n   */\n  addDays(date, days) {\n    const result = new Date(date);\n    result.setDate(result.getDate() + days);\n    return result;\n  }\n\n  /**\n   * Format date for API requests (YYYYMMDD)\n   * @param {Date} date - Date to format\n   * @returns {string} Formatted date\n   */\n  formatDate(date) {\n    return date.toISOString().split('T')[0].replace(/-/g, '');\n  }\n\n  /**\n   * Format date with dashes (YYYY-MM-DD)\n   * @param {Date} date - Date to format\n   * @returns {string} Formatted date\n   */\n  formatDateWithDashes(date) {\n    return date.toISOString().split('T')[0];\n  }\n\n  /**\n   * Get disaster events for storm tracking\n   * @param {number} days - Number of days to look back\n   * @param {string} status - Event status filter\n   * @returns {Promise<Array>} Array of disaster events\n   */\n  async getDisasterEvents(days = 30, status = 'open') {\n    try {\n      if (!this.config.enableDisasterTracking) {\n        console.log('Disaster tracking is disabled');\n        return [];\n      }\n      return await this.disasterTrackingService.fetchDisasterEvents(days, status);\n    } catch (error) {\n      console.error('Error fetching disaster events:', error);\n      return [];\n    }\n  }\n\n  /**\n   * Get space weather data independently\n   * @param {string} targetDate - Target date for analysis\n   * @param {number} dayRange - Number of days to look around target date\n   */\n\n  /**\n   * Generate a weather summary based on nearby events\n   * @param {Array} events - Nearby weather events\n   * @returns {string} Summary text\n   */\n  generateWeatherSummary(nearbyEvents, spaceWeatherData) {\n    const summaryParts = [];\n\n    // Ground weather events summary\n    if (nearbyEvents && nearbyEvents.length > 0) {\n      const severityCount = nearbyEvents.reduce((acc, event) => {\n        acc[event.severity] = (acc[event.severity] || 0) + 1;\n        return acc;\n      }, {});\n      const parts = [];\n      if (severityCount.severe) {\n        parts.push(`${severityCount.severe} severe weather event${severityCount.severe > 1 ? 's' : ''}`);\n      }\n      if (severityCount.moderate) {\n        parts.push(`${severityCount.moderate} moderate event${severityCount.moderate > 1 ? 's' : ''}`);\n      }\n      if (severityCount.mild) {\n        parts.push(`${severityCount.mild} mild event${severityCount.mild > 1 ? 's' : ''}`);\n      }\n      summaryParts.push(`Found ${nearbyEvents.length} weather events in your area: ${parts.join(', ')}`);\n    } else {\n      summaryParts.push('No significant weather events in your area');\n    }\n\n    // Space weather summary\n    if (spaceWeatherData) {\n      if (spaceWeatherData.summary.activityLevel !== 'Quiet') {\n        summaryParts.push(`Space weather activity: ${spaceWeatherData.summary.activityLevel}`);\n        if (spaceWeatherData.warnings && spaceWeatherData.warnings.length > 0) {\n          summaryParts.push(`Space weather warnings: ${spaceWeatherData.warnings.join('; ')}`);\n        }\n        const impacts = Object.entries(spaceWeatherData.summary.impacts).filter(([_, isImpacted]) => isImpacted).map(([system]) => system);\n        if (impacts.length > 0) {\n          summaryParts.push(`Potential impacts on: ${impacts.join(', ')}`);\n        }\n      } else {\n        summaryParts.push('Space weather conditions are quiet');\n      }\n    }\n    return summaryParts.join('. ') + '.';\n  }\n\n  /**\n   * Validate coordinates\n   * @param {number} lat - Latitude\n   * @param {number} lon - Longitude\n   * @returns {boolean} Whether coordinates are valid\n   */\n  isValidCoordinates(lat, lon) {\n    return !isNaN(lat) && !isNaN(lon) && lat >= -90 && lat <= 90 && lon >= -180 && lon <= 180;\n  }\n\n  /**\n   * @param {number} dayRange - Number of days to look around target date\n   * @returns {Promise<Object>} Space weather data\n   */\n  async getSpaceWeatherData(targetDate, dayRange = 7) {\n    try {\n      if (!this.config.enableSpaceWeather) {\n        console.log('Space weather tracking is disabled');\n        return this.spaceWeatherService.generateDefaultSpaceWeatherData();\n      }\n      return await this.spaceWeatherService.fetchSpaceWeatherData(targetDate, dayRange);\n    } catch (error) {\n      console.error('Error fetching space weather data:', error);\n      return this.spaceWeatherService.generateDefaultSpaceWeatherData();\n    }\n  }\n\n  /**\n   * Filter disaster events by criteria\n   * @param {Array} events - Array of disaster events\n   * @param {Object} filters - Filter criteria\n   * @returns {Array} Filtered events\n   */\n  filterDisasterEvents(events, filters = {}) {\n    let filteredEvents = [...events];\n    if (filters.category && filters.category !== 'all') {\n      filteredEvents = this.disasterTrackingService.filterByCategory(filteredEvents, filters.category);\n    }\n    if (filters.severity && filters.severity !== 'all') {\n      filteredEvents = this.disasterTrackingService.filterBySeverity(filteredEvents, filters.severity);\n    }\n    return filteredEvents;\n  }\n\n  /**\n   * Get disaster event statistics\n   * @param {Array} events - Array of disaster events\n   * @returns {Object} Event statistics\n   */\n  getDisasterStatistics(events) {\n    return this.disasterTrackingService.getEventStatistics(events);\n  }\n\n  /**\n   * Get event icon for disaster category\n   * @param {string} categoryId - Event category ID\n   * @returns {string} Emoji icon\n   */\n  getDisasterEventIcon(categoryId) {\n    return this.disasterTrackingService.getEventIcon(categoryId);\n  }\n\n  /**\n   * Export weather data in specified format\n   * @param {Object} data - Weather data to export\n   * @param {string} format - Export format ('json' or 'csv')\n   * @returns {string|Object} Formatted export data\n   */\n  exportData(data, format = 'json') {\n    const {\n      formatForExport\n    } = require('./utils/dataProcessor.js');\n    return formatForExport(data, format);\n  }\n\n  /**\n   * Get service status and configuration\n   * @returns {Object} Service status information\n   */\n  getServiceStatus() {\n    return {\n      services: {\n        meteomatics: this.meteomaticsService.getApiStatus(),\n        spaceWeather: {\n          service: 'NASA DONKI Space Weather',\n          enabled: this.config.enableSpaceWeather,\n          apiKey: this.spaceWeatherService.apiKey ? 'configured' : 'missing'\n        },\n        disasterTracking: {\n          service: 'NASA EONET Disaster Tracking',\n          enabled: this.config.enableDisasterTracking,\n          baseUrl: this.disasterTrackingService.baseUrl\n        }\n      },\n      configuration: this.config,\n      lastUpdated: new Date().toISOString()\n    };\n  }\n\n  /**\n   * Update service configuration\n   * @param {Object} newConfig - New configuration options\n   */\n  updateConfiguration(newConfig) {\n    this.config = {\n      ...this.config,\n      ...newConfig\n    };\n    console.log('Service configuration updated:', this.config);\n  }\n\n  /**\n   * Health check for all services\n   * @returns {Promise<Object>} Health status of all services\n   */\n  async healthCheck() {\n    const health = {\n      overall: 'healthy',\n      services: {},\n      timestamp: new Date().toISOString()\n    };\n    try {\n      // Check Meteomatics service\n      health.services.meteomatics = {\n        status: this.meteomaticsService.validateCredentials() ? 'healthy' : 'degraded',\n        message: 'Credentials validated'\n      };\n\n      // Check space weather service\n      try {\n        await this.spaceWeatherService.generateDefaultSpaceWeatherData();\n        health.services.spaceWeather = {\n          status: 'healthy',\n          message: 'Service operational'\n        };\n      } catch (error) {\n        health.services.spaceWeather = {\n          status: 'unhealthy',\n          message: error.message\n        };\n        health.overall = 'degraded';\n      }\n\n      // Check disaster tracking service\n      try {\n        const testEvents = this.disasterTrackingService.getEventStatistics([]);\n        health.services.disasterTracking = {\n          status: 'healthy',\n          message: 'Service operational'\n        };\n      } catch (error) {\n        health.services.disasterTracking = {\n          status: 'unhealthy',\n          message: error.message\n        };\n        health.overall = 'degraded';\n      }\n    } catch (error) {\n      health.overall = 'unhealthy';\n      health.error = error.message;\n    }\n    return health;\n  }\n}\n\n// Export singleton instance\nexport const weatherService = new WeatherService();\nexport default WeatherService;","map":{"version":3,"names":["DisasterTrackingService","EonetService","PowerService","DonkiService","processHistoricalData","mergeDataSources","validateDataIntegrity","WeatherService","constructor","disasterTrackingService","eonetService","powerService","donkiService","config","enableDisasterTracking","enableSpaceWeather","defaultDayRange","maxRetries","getWeatherAnalysis","lat","lon","targetDate","console","log","isValidCoordinates","Error","targetDateObj","Date","isNaN","getTime","startDateObj","endDateObj","setDate","getDate","formattedStartDate","formatDateWithDashes","formattedEndDate","coordinates","apiResults","Promise","allSettled","fetchWeatherData","catch","error","temperature","precipitation","humidity","getWeatherEvents","days","status","events","alerts","fetchSpaceWeatherData","solarFlares","geomagneticStorms","value","powerWeatherData","eonetData","donkiData","stormData","nearbyEvents","weatherData","spaceWeatherData","all","err","warn","getNearbyEvents","getWeatherData","powerStartDate","powerEndDate","getSpaceWeatherData","processedWeatherData","currentWeather","Array","isArray","targetDateFormatted","formatDate","find","d","date","mergedData","storms","location","Number","toFixed","summary","generateWeatherSummary","weather","historical","current","isValid","spaceWeather","activityLevel","eventCounts","impacts","warnings","validation","errors","windSpeed","condition","dataTimestamp","toISOString","dataSources","eonet","power","donki","addDays","result","split","replace","getDisasterEvents","fetchDisasterEvents","summaryParts","length","severityCount","reduce","acc","event","severity","parts","severe","push","moderate","mild","join","Object","entries","filter","_","isImpacted","map","system","dayRange","spaceWeatherService","generateDefaultSpaceWeatherData","filterDisasterEvents","filters","filteredEvents","category","filterByCategory","filterBySeverity","getDisasterStatistics","getEventStatistics","getDisasterEventIcon","categoryId","getEventIcon","exportData","data","format","formatForExport","require","getServiceStatus","services","meteomatics","meteomaticsService","getApiStatus","service","enabled","apiKey","disasterTracking","baseUrl","configuration","lastUpdated","updateConfiguration","newConfig","healthCheck","health","overall","timestamp","validateCredentials","message","testEvents","weatherService"],"sources":["C:/xampp/htdocs/errors/src/services/weatherService.js"],"sourcesContent":["import DisasterTrackingService from './api/disasterTrackingService.js';\nimport EonetService from './api/eonetService.js';\nimport PowerService from './api/powerService.js';\nimport DonkiService from './api/donkiService.js';\nimport { processHistoricalData, mergeDataSources, validateDataIntegrity } from './utils/dataProcessor.js';\n\n/**\n * Main Weather Service - Orchestrates all weather-related data sources\n * This is the primary service that components should interact with\n */\nclass WeatherService {\n  constructor() {\n    // Initialize individual service modules\n    this.disasterTrackingService = new DisasterTrackingService();\n    this.eonetService = EonetService;\n    this.powerService = PowerService;\n    this.donkiService = DonkiService;\n    \n    // Service configuration\n    this.config = {\n      enableDisasterTracking: true,\n      enableSpaceWeather: true,\n      defaultDayRange: 7,\n      maxRetries: 3\n    };\n  }\n\n  /**\n   * Get comprehensive weather data for a location and date\n   * @param {number} lat - Latitude\n   * @param {number} lon - Longitude\n   * @param {string} targetDate - Target date for analysis\n   * @returns {Promise<Object>} Complete weather analysis\n   */\n  async getWeatherAnalysis(lat, lon, targetDate) {\n    try {\n      console.log(`Fetching comprehensive weather analysis for ${lat}, ${lon} on ${targetDate}`);\n      \n      // Validate inputs\n      if (!this.isValidCoordinates(lat, lon)) {\n        throw new Error('Invalid coordinates provided');\n      }\n\n      // Ensure targetDate is a Date object and in ISO format\n      const targetDateObj = new Date(targetDate);\n      if (isNaN(targetDateObj.getTime())) {\n        throw new Error('Invalid date format provided');\n      }\n\n      // Calculate date range for weather data\n      const startDateObj = new Date(targetDateObj);\n      const endDateObj = new Date(targetDateObj);\n      startDateObj.setDate(startDateObj.getDate() - this.config.defaultDayRange);\n      endDateObj.setDate(endDateObj.getDate() + this.config.defaultDayRange);\n\n      // Format dates for different APIs and prepare parameters\n      const formattedStartDate = this.formatDateWithDashes(startDateObj);\n      const formattedEndDate = this.formatDateWithDashes(endDateObj);\n      const coordinates = { lat, lon };\n\n      // Fetch data from all sources in parallel with robust error handling\n      const apiResults = await Promise.allSettled([\n        // Weather data from POWER API\n        this.powerService.fetchWeatherData(coordinates, formattedStartDate, formattedEndDate)\n          .catch(error => {\n            console.error('Weather data fetch failed:', error);\n            return { temperature: null, precipitation: null, humidity: null };\n          }),\n\n        // Storm events from EONET\n        this.eonetService.getWeatherEvents({ \n          days: this.config.defaultDayRange,\n          status: 'all' \n        }).catch(error => {\n          console.error('Storm data fetch failed:', error);\n          return { events: [], alerts: [] };\n        }),\n\n        // Space weather from DONKI\n        this.donkiService.fetchSpaceWeatherData(formattedStartDate, formattedEndDate)\n          .catch(error => {\n            console.error('Space weather data fetch failed:', error);\n            return { solarFlares: [], geomagneticStorms: [] };\n          })\n      ]);\n\n      // Extract data with proper typing and fallbacks\n      const [\n        { value: powerWeatherData = { temperature: null, precipitation: null, humidity: null } },\n        { value: eonetData = { events: [], alerts: [] } },\n        { value: donkiData = { solarFlares: [], geomagneticStorms: [] } }\n      ] = apiResults;\n\n      console.log('Fetching data for date range:', formattedStartDate, 'to', formattedEndDate);\n\n      // Fetch data from all sources in parallel\n      const [stormData, nearbyEvents, weatherData, spaceWeatherData] = await Promise.all([\n        this.eonetService.getWeatherEvents({ \n          days: this.config.defaultDayRange,\n          status: 'all' \n        }).catch(err => {\n          console.warn('EONET fetch failed:', err);\n          return [];\n        }),\n        this.eonetService.getNearbyEvents(lat, lon, 500).catch(err => {\n          console.warn('Nearby events fetch failed:', err);\n          return [];\n        }),\n        this.powerService.getWeatherData(\n          lat,\n          lon,\n          powerStartDate,\n          powerEndDate\n        ).catch(err => {\n          console.warn('NASA POWER fetch failed:', err);\n          return null;\n        }),\n        this.config.enableSpaceWeather\n          ? this.donkiService.getSpaceWeatherData(formattedStartDate, formattedEndDate)\n              .catch(err => {\n                console.warn('DONKI fetch failed:', err);\n                return null;\n              })\n          : null\n      ]);\n\n      // Process and validate weather data\n      let processedWeatherData = null;\n      let currentWeather = null;\n\n      if (weatherData && Array.isArray(weatherData)) {\n        try {\n          processedWeatherData = processHistoricalData(weatherData);\n          const targetDateFormatted = this.formatDate(targetDateObj);\n          currentWeather = weatherData.find(d => d.date === targetDateFormatted) || null;\n        } catch (err) {\n          console.warn('Error processing weather data:', err);\n        }\n      }\n\n      // Ensure all data is properly structured\n      const mergedData = {\n        storms: Array.isArray(stormData) ? stormData : [],\n        nearbyEvents: Array.isArray(nearbyEvents) ? nearbyEvents : [],\n        location: { \n          lat: Number(lat).toFixed(4),\n          lon: Number(lon).toFixed(4)\n        },\n        date: this.formatDateWithDashes(targetDateObj),\n        summary: this.generateWeatherSummary(\n          Array.isArray(nearbyEvents) ? nearbyEvents : [],\n          spaceWeatherData\n        ),\n        weather: {\n          historical: processedWeatherData,\n          current: currentWeather,\n          isValid: !!processedWeatherData\n        },\n        spaceWeather: spaceWeatherData || {\n          events: {},\n          summary: {\n            activityLevel: 'Unknown',\n            eventCounts: {},\n            impacts: {}\n          },\n          warnings: []\n        }\n      };\n\n      // Validate data integrity and add fallback data if needed\n      const validation = validateDataIntegrity(mergedData);\n      \n      if (!validation.isValid) {\n        console.warn('Data validation warnings:', validation.errors);\n        \n        // Add fallback data for missing components\n        if (!mergedData.weather.current) {\n          mergedData.weather.current = {\n            temperature: null,\n            precipitation: null,\n            windSpeed: null,\n            humidity: null,\n            condition: 'Unknown'\n          };\n        }\n      }\n\n      // Add validation results and metadata\n      mergedData.validation = {\n        ...validation,\n        dataTimestamp: new Date().toISOString(),\n        dataSources: {\n          eonet: !!stormData,\n          power: !!weatherData,\n          donki: !!spaceWeatherData\n        }\n      };\n      \n      console.log('Weather analysis completed successfully');\n      return mergedData;\n\n    } catch (error) {\n      console.error('Error in weather analysis:', error);\n      throw error;\n    }\n  }\n\n  /**\n   * Add days to a date\n   * @param {string|Date} date - Input date\n   * @param {number} days - Number of days to add\n   * @returns {Date} Resulting date\n   */\n  addDays(date, days) {\n    const result = new Date(date);\n    result.setDate(result.getDate() + days);\n    return result;\n  }\n\n  /**\n   * Format date for API requests (YYYYMMDD)\n   * @param {Date} date - Date to format\n   * @returns {string} Formatted date\n   */\n  formatDate(date) {\n    return date.toISOString().split('T')[0].replace(/-/g, '');\n  }\n\n  /**\n   * Format date with dashes (YYYY-MM-DD)\n   * @param {Date} date - Date to format\n   * @returns {string} Formatted date\n   */\n  formatDateWithDashes(date) {\n    return date.toISOString().split('T')[0];\n  }\n\n  /**\n   * Get disaster events for storm tracking\n   * @param {number} days - Number of days to look back\n   * @param {string} status - Event status filter\n   * @returns {Promise<Array>} Array of disaster events\n   */\n  async getDisasterEvents(days = 30, status = 'open') {\n    try {\n      if (!this.config.enableDisasterTracking) {\n        console.log('Disaster tracking is disabled');\n        return [];\n      }\n\n      return await this.disasterTrackingService.fetchDisasterEvents(days, status);\n    } catch (error) {\n      console.error('Error fetching disaster events:', error);\n      return [];\n    }\n  }\n\n  /**\n   * Get space weather data independently\n   * @param {string} targetDate - Target date for analysis\n   * @param {number} dayRange - Number of days to look around target date\n   */\n\n  /**\n   * Generate a weather summary based on nearby events\n   * @param {Array} events - Nearby weather events\n   * @returns {string} Summary text\n   */\n  generateWeatherSummary(nearbyEvents, spaceWeatherData) {\n    const summaryParts = [];\n\n    // Ground weather events summary\n    if (nearbyEvents && nearbyEvents.length > 0) {\n      const severityCount = nearbyEvents.reduce((acc, event) => {\n        acc[event.severity] = (acc[event.severity] || 0) + 1;\n        return acc;\n      }, {});\n\n      const parts = [];\n      if (severityCount.severe) {\n        parts.push(`${severityCount.severe} severe weather event${severityCount.severe > 1 ? 's' : ''}`);\n      }\n      if (severityCount.moderate) {\n        parts.push(`${severityCount.moderate} moderate event${severityCount.moderate > 1 ? 's' : ''}`);\n      }\n      if (severityCount.mild) {\n        parts.push(`${severityCount.mild} mild event${severityCount.mild > 1 ? 's' : ''}`);\n      }\n\n      summaryParts.push(`Found ${nearbyEvents.length} weather events in your area: ${parts.join(', ')}`);\n    } else {\n      summaryParts.push('No significant weather events in your area');\n    }\n\n    // Space weather summary\n    if (spaceWeatherData) {\n      if (spaceWeatherData.summary.activityLevel !== 'Quiet') {\n        summaryParts.push(`Space weather activity: ${spaceWeatherData.summary.activityLevel}`);\n        \n        if (spaceWeatherData.warnings && spaceWeatherData.warnings.length > 0) {\n          summaryParts.push(`Space weather warnings: ${spaceWeatherData.warnings.join('; ')}`);\n        }\n\n        const impacts = Object.entries(spaceWeatherData.summary.impacts)\n          .filter(([_, isImpacted]) => isImpacted)\n          .map(([system]) => system);\n\n        if (impacts.length > 0) {\n          summaryParts.push(`Potential impacts on: ${impacts.join(', ')}`);\n        }\n      } else {\n        summaryParts.push('Space weather conditions are quiet');\n      }\n    }\n\n    return summaryParts.join('. ') + '.';\n  }\n\n  /**\n   * Validate coordinates\n   * @param {number} lat - Latitude\n   * @param {number} lon - Longitude\n   * @returns {boolean} Whether coordinates are valid\n   */\n  isValidCoordinates(lat, lon) {\n    return !isNaN(lat) && !isNaN(lon) && \n           lat >= -90 && lat <= 90 && \n           lon >= -180 && lon <= 180;\n  }\n\n  /**\n   * @param {number} dayRange - Number of days to look around target date\n   * @returns {Promise<Object>} Space weather data\n   */\n  async getSpaceWeatherData(targetDate, dayRange = 7) {\n    try {\n      if (!this.config.enableSpaceWeather) {\n        console.log('Space weather tracking is disabled');\n        return this.spaceWeatherService.generateDefaultSpaceWeatherData();\n      }\n\n      return await this.spaceWeatherService.fetchSpaceWeatherData(targetDate, dayRange);\n    } catch (error) {\n      console.error('Error fetching space weather data:', error);\n      return this.spaceWeatherService.generateDefaultSpaceWeatherData();\n    }\n  }\n\n  /**\n   * Filter disaster events by criteria\n   * @param {Array} events - Array of disaster events\n   * @param {Object} filters - Filter criteria\n   * @returns {Array} Filtered events\n   */\n  filterDisasterEvents(events, filters = {}) {\n    let filteredEvents = [...events];\n\n    if (filters.category && filters.category !== 'all') {\n      filteredEvents = this.disasterTrackingService.filterByCategory(filteredEvents, filters.category);\n    }\n\n    if (filters.severity && filters.severity !== 'all') {\n      filteredEvents = this.disasterTrackingService.filterBySeverity(filteredEvents, filters.severity);\n    }\n\n    return filteredEvents;\n  }\n\n  /**\n   * Get disaster event statistics\n   * @param {Array} events - Array of disaster events\n   * @returns {Object} Event statistics\n   */\n  getDisasterStatistics(events) {\n    return this.disasterTrackingService.getEventStatistics(events);\n  }\n\n  /**\n   * Get event icon for disaster category\n   * @param {string} categoryId - Event category ID\n   * @returns {string} Emoji icon\n   */\n  getDisasterEventIcon(categoryId) {\n    return this.disasterTrackingService.getEventIcon(categoryId);\n  }\n\n  /**\n   * Export weather data in specified format\n   * @param {Object} data - Weather data to export\n   * @param {string} format - Export format ('json' or 'csv')\n   * @returns {string|Object} Formatted export data\n   */\n  exportData(data, format = 'json') {\n    const { formatForExport } = require('./utils/dataProcessor.js');\n    return formatForExport(data, format);\n  }\n\n  /**\n   * Get service status and configuration\n   * @returns {Object} Service status information\n   */\n  getServiceStatus() {\n    return {\n      services: {\n        meteomatics: this.meteomaticsService.getApiStatus(),\n        spaceWeather: {\n          service: 'NASA DONKI Space Weather',\n          enabled: this.config.enableSpaceWeather,\n          apiKey: this.spaceWeatherService.apiKey ? 'configured' : 'missing'\n        },\n        disasterTracking: {\n          service: 'NASA EONET Disaster Tracking',\n          enabled: this.config.enableDisasterTracking,\n          baseUrl: this.disasterTrackingService.baseUrl\n        }\n      },\n      configuration: this.config,\n      lastUpdated: new Date().toISOString()\n    };\n  }\n\n  /**\n   * Update service configuration\n   * @param {Object} newConfig - New configuration options\n   */\n  updateConfiguration(newConfig) {\n    this.config = { ...this.config, ...newConfig };\n    console.log('Service configuration updated:', this.config);\n  }\n\n  /**\n   * Health check for all services\n   * @returns {Promise<Object>} Health status of all services\n   */\n  async healthCheck() {\n    const health = {\n      overall: 'healthy',\n      services: {},\n      timestamp: new Date().toISOString()\n    };\n\n    try {\n      // Check Meteomatics service\n      health.services.meteomatics = {\n        status: this.meteomaticsService.validateCredentials() ? 'healthy' : 'degraded',\n        message: 'Credentials validated'\n      };\n\n      // Check space weather service\n      try {\n        await this.spaceWeatherService.generateDefaultSpaceWeatherData();\n        health.services.spaceWeather = { status: 'healthy', message: 'Service operational' };\n      } catch (error) {\n        health.services.spaceWeather = { status: 'unhealthy', message: error.message };\n        health.overall = 'degraded';\n      }\n\n      // Check disaster tracking service\n      try {\n        const testEvents = this.disasterTrackingService.getEventStatistics([]);\n        health.services.disasterTracking = { status: 'healthy', message: 'Service operational' };\n      } catch (error) {\n        health.services.disasterTracking = { status: 'unhealthy', message: error.message };\n        health.overall = 'degraded';\n      }\n\n    } catch (error) {\n      health.overall = 'unhealthy';\n      health.error = error.message;\n    }\n\n    return health;\n  }\n}\n\n// Export singleton instance\nexport const weatherService = new WeatherService();\nexport default WeatherService;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}